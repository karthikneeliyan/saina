function validEmail(e){return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(e)}function validateHuman(e){if(e)return console.log("Robot Detected!"),!0;console.log("Welcome Human!")}function getFormData(){var e=document.getElementById("gform"),t=e.elements,n=Object.keys(t).filter(function(e){return"honeypot"!==t[e].name}).map(function(e){return void 0!==t[e].name?t[e].name:t[e].length>0?t[e].item(0).name:void 0}).filter(function(e,t,n){return n.indexOf(e)==t&&e}),o={};return n.forEach(function(e){o[e]=t[e].value;var n="";if("checkbox"===t[e].type)n=n+t[e].checked+", ",o[e]=n.slice(0,-2);else if(t[e].length)for(var a=0;a<t[e].length;a++)t[e].item(a).checked&&(n=n+t[e].item(a).value+", ",o[e]=n.slice(0,-2))}),o.formDataNameOrder=JSON.stringify(n),o.formGoogleSheetName=e.dataset.sheet||"responses",o.formGoogleSendEmail=e.dataset.email||"",console.log(o),o}function handleFormSubmit(e){e.preventDefault();var t=getFormData();if(validateHuman(t.honeypot))return!1;if(t.email&&!validEmail(t.email)){var n=document.getElementById("email-invalid");if(n)return n.style.display="block",!1}else{var o=e.target.action,a=new XMLHttpRequest;a.open("POST",o),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){console.log(a.status,a.statusText),console.log(a.responseText),document.getElementById("gform").style.display="none";var e=document.getElementById("thankyou_message");e&&(e.style.display="block")};var l=Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&");a.send(l)}}function loaded(){document.getElementById("gform").addEventListener("submit",handleFormSubmit,!1)}document.addEventListener("DOMContentLoaded",loaded,!1);